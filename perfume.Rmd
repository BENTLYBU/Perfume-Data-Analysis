---
title: "Perfume"
output: html_document
date: "2025-09-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Perfume Dataset Analysis (R)

This repository contains exploratory data analysis of the [Perfume Dataset](https://www.kaggle.com/datasets/ayushghawana/perfume-dataset) using **R**.

## ğŸ“Œ Introduction
Perfume is a lifestyle and fashion product that combines **brand identity, pricing, consumer preferences, and sensory attributes**.  
This project aims to explore patterns within the perfume dataset to understand:
- Brand distribution
- Pricing strategies
- Consumer ratings
- Longevity and sillage (lasting power & scent projection)

## ğŸ› ï¸ Tools
- **RStudio / R Markdown**
- R packages: `tidyverse`, `dplyr`, `ggplot2`, `readr`, `stringr`

```{r}
# Define function to check is package is installed
install_if_missing <- function(pkg){
  if (!require(pkg, character.only = TRUE)) {
    install.packages(pkg, dependencies = TRUE, repos = "https://cloud.r-project.org/")
    library(pkg, character.only = TRUE)
  }
}

# Install and load library
pkgs <- c("readr","dplyr","tidyr","stringr","janitor","ggplot2","ggrepel")
invisible(lapply(pkgs, install_if_missing))

```


## ğŸ“‚ Project Structure
- `data/` â†’ raw dataset and cleaned dataset
- `scripts/` â†’ R scripts for data cleaning, analysis, visualization, modeling
- `notebooks/` â†’ R Markdown for step-by-step analysis
- `outputs/` â†’ figures, reports
- `docs/` â†’ research notes, methodology

## â“ Research Questions
1.Market share of men's and women's fragrances
2.Number of perfumes under each brands
3.Market shaer of each category and type
4.Gender preference of category and type
5.Will type/Category influence longevity 

## ğŸš€ Next Steps
- Perform data cleaning (handle missing values, duplicates, normalize categories)
- Conduct exploratory data analysis (EDA)
- Build visualizations with `ggplot2`
- Explore clustering/ML models (e.g., k-means, regression)

# Data read and clearning

```{r}
# Read in csv

perfume <- read.csv("Data/Perfumes_dataset.csv")

# Standarise
perfume <- perfume |>
  janitor::clean_names() |>
  dplyr::mutate(
    brand           = stringr::str_squish(brand),
    perfume         = stringr::str_squish(perfume),
    type            = stringr::str_squish(stringr::str_to_lower(type)),        # e.g. "edp", "edt"
    category        = stringr::str_squish(stringr::str_to_title(category)),    # "Fresh Scent" etc.
    target_audience = stringr::str_squish(stringr::str_to_title(target_audience)), # "Male/Female/Unisex"
    longevity       = stringr::str_squish(stringr::str_to_title(longevity))    # "Strong/Medium/..."
  )


```

```{r}
perfume[1:10,]
glimpse(perfume)
summary(perfume)
```
## Columns

*brand* â€“ The company or label that produces the perfume (e.g., Dumont).

*perfume* â€“ The name of the fragrance (e.g., Nitro Red).

*type* â€“ Concentration or formulation of the perfume (e.g., EDP â€“ Eau de Parfum).

*category* â€“ Classification of the fragrance based on scent family or style (e.g., Fresh Scent, Woody Spicy, Oriental Vanilla).

*target_audience* â€“ The intended wearer of the perfume (e.g., Male, Female, Unisex).

*longevity* â€“ Expected performance in terms of duration on the skin (e.g., Strong, Medium).

## Example Entries

*Nitro Red (Dumont, EDP)* â€“ A fresh scent designed for men with strong longevity.

*Celerio Oros (Dumont, EDP)* â€“ An oriental vanilla fragrance suitable for unisex wearers with medium longevity.

*Nitro Black (Dumont, EDP)* â€“ A woody spicy perfume for men with strong performance.

```{r}
# Find number of unique value in each column
sapply(perfume, function(x) length(unique(x)))
```
## Q1 Market share of men's and women's fragrances

```{r}
count_share <- function(df, group_vars){
  df |>
    dplyr::count(dplyr::across({{ group_vars }}), name = "n") |>
    dplyr::mutate(share = n / sum(n)) |>
    dplyr::arrange(dplyr::desc(n))
}

market_share_all <- count_share(perfume, target_audience)
print(market_share_all)
```

```{r}
# (B) åªçœ‹ç”·å¥³ï¼ˆå»æ‰æˆ–å¿½ç•¥ Unisexï¼‰
market_share_mf <- perfume |>
  dplyr::filter(target_audience %in% c("Male","Female")) |>
  count_share(target_audience)
cat("\n-- Male vs Female (excluding Unisex) --\n")
print(market_share_mf)
```


```{r}


market_share_all <- tibble::tibble(
  target_audience = c("Male","Female","Unisex"),
  n = c(375, 312, 88)
) %>%
  mutate(share = n / sum(n))

pie_df <- market_share_all %>%
  arrange(desc(share)) %>%
  mutate(
    label = paste0(target_audience, " (", percent(share, accuracy = 0.1), ")"),
    ypos  = cumsum(share) - share/2   # è§’åº¦ä¸­ç‚¹ï¼ˆé…åˆ coord_polar(theta="y")ï¼‰
  )
pie_df
# ç»˜å›¾
ggplot(pie_df, aes(x = 1, y = share, fill = target_audience)) +
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  # å¤–ç½®æ ‡ç­¾ï¼šy ç”¨ä¸­ç‚¹ yposï¼Œx å›ºå®šåœ¨åŠå¾„=1ï¼Œå†ç”¨ nudge_x å¾€å¤–æ¨
  geom_label_repel(
    aes(y = ypos, label = label),
    x = 1,                 # åŠå¾„ä½ç½®
    nudge_x = 0.6,         # å¾€å¤–åç§»ï¼Œè°ƒå¤§æ›´é å¤–
    direction = "y",       # å‚ç›´æ–¹å‘æ’å¸ƒæ›´æ•´é½
    min.segment.length = 0, 
    segment.size = 0.5,
    segment.color = "grey40",
    box.padding = 0.25,
    point.padding = 0.2,
    size = 4,
    show.legend = FALSE
  ) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Market Share of Fragrances by Target Audience",
    fill  = "Target Audience"
  ) +
  theme_void(base_size = 14) +
  theme(legend.position = "bottom")
  
```


## Q2 Number of perfumes under each brands

```{r}
brand_counts <- perfume |>
  dplyr::count(brand, name = "n") |>
  dplyr::arrange(dplyr::desc(n))
print(head(brand_counts, 20)) # å‰ 20 ä¸ªå“ç‰Œ
# å¦‚æœè¦å…¨éƒ¨ï¼Œè¯·ç›´æ¥ print(brand_counts)
```

